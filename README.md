# Diabetes Management API

## О проекте
Этот проект представляет собой самописный API на базе **FastAPI** для управления записями уровня глюкозы у диабетиков. Я написала его в качестве пет-проекта для демонстрации своих навыков в автоматизации тестирования API, так как не смогла найти ничего интересного в мире открытых API :)
Он демонстрирует:
- CRUD-операции (создание, чтение, обновление, удаление) для записей уровня глюкозы.
- Автоматизированное тестирование с использованием библиотек **pytest** и **requests**.
- Генерацию HTML-отчетов с помощью **pytest-html** (и при желании Allure, но отчеты в Allure пока формируются плохо).
- CI/CD-пайплайн на базе **GitHub Actions**, который автоматически запускает тесты при каждом пуше.


Для интересующихся:
- глюкоза - показатель сахара в крови, диабетики измеряют его регулярно, так как в отличии от здоровых людей он постоянно изменяется
- глюкоза измеряется в миллимолях на литр (ммоль/л) в странах СНГ, а также в миллиграммах на децилитр (мг/дл) в США, странах Западной Европы и др. Мой апи не привязан к конкретной единице измерения - как хотите, так и вносите

## Технологии, которые я использовала в данном пет-проекте
- **FastAPI** – фреймворк для создания RESTful API.
- **Uvicorn** – ASGI-сервер для запуска приложения.
- **Pydantic** – определение и валидация моделей данных.
- **pytest** – фреймворк для написания тестов.
- **pytest-html** – плагин для генерации HTML-отчетов о тестах.
- **GitHub Actions** – для автоматизации CI/CD.

##### Для тестирования данный API нужно развернуть локально. Ниже привожу инструкцию для установки и запуска и API, и автотестов.

## Установка и запуск

1. **Клонируйте репозиторий:**
   git clone https://github.com/Woterminze/DiabetesManagmentAPI.git
   cd DiabetesManagmentAPI
2. **Создайте и активируете venv (виртуальное окружение)**
- Для Windows
    python -m venv venv
    venv\Scripts\activate.bat
- Для macOS/Linux
    python -m venv venv
    source venv/bin/activate
3. **Установите зависимости**
  pip install fastapi uvicorn pytest pytest-html requests allure-pytest
Это все бибилиотеки, которые я использовала в API
4. **Запустите сервер**
  Для запуска используйте команду: uvicorn main:app --reload --port 3000
  Сервер будет доступен по адресу: http://127.0.0.1:3000
  Документация Swagger UI доступна по адресу: http://127.0.0.1:3000/docs
5. **Запуск автотестов**
  Для запуска автотестов (файл test_api.py) испольузйте команду: pytest --html=report.html --self-contained-html
  Сразу после выполнения автотестов сформируется отчет
6. **Запуск автотестов с Allure**
  Для запуска тестов и генерации красивого отчета используйте команды: 
  pytest --alluredir=allure-results   
  allure serve allure-results

  ## Примеры использования API
  1. **Получение списка всех записей о глюкозе (метод GET)**
  curl -X GET "http://127.0.0.1:3000/glucose" -H "accept: application/json"
  2. **Создание записи о глюкозе(метод POST)**
  curl -X POST "http://127.0.0.1:3000/glucose" \
  -H "Content-Type: application/json" \
  -d "{
    \"user_id\": 1,
    \"glucose_level\": 7.5,
    \"measurement_time\": \"2025-02-19T08:00:00\",
    \"notes\": \"Натощак\"
  }"
  3. **Обновление записи о глюкозе(метод PUT)**
  curl -X PUT "http://127.0.0.1:3000/glucose/1" \
  -H "Content-Type: application/json" \
  -d "{
    \"user_id\": 1,
    \"glucose_level\": 8.0,
    \"measurement_time\": \"2025-02-19T09:30:00\",
    \"notes\": \"Обновленная запись\"
  }"
  4. **Удаление записи(метод DELETE)**
  curl -X DELETE "http://127.0.0.1:3000/glucose/1"

## CI/CD
Проект настроен на автоматический запуск тестов через GitHub Actions при каждом пуше в репозиторий.
Пример конфигурационного файла для GitHub Actions находится в .github/workflows/ci.yml и включает следующие шаги:
- Checkout репозитория.
- Установка Python и зависимостей.
- Запуск FastAPI-сервера в фоне с wait loop.
- Выполнение тестов с генерацией HTML-отчетов (pytest-html) и результатов для Allure.
- Генерация отчёта Allure и загрузка его как артефакта.  
Так как генерация отчета в Allure пока хромает, в yml-файле так же описана генерация отчета силами **pytest**, можно оставить только ее.

## Нюансы!
- В проекте пока нет БД, вместо нее я использую обычный List, поэтому после рестарта данные затираются. Когда-нибудь сделаю привязку к БД.
- Allure-отчеты работают странно, разбираюсь с этим.
- Этот проект - тестовый. Я не разработчик, а тестировщик, и знаю, что можно лучше. В будущем планирую улучшить код и докинуть тестов.

## О себе:
Я - Копташкина Татьяна, qa - engineer с 4-х летним коммерческим опытом. Я занималась в основном ручным тестированием, поэтому очень хочу развиваться в backend-тестировании и автоматизации, чтобы стать полноценным fullstack-qa.  
А этот проект я сделала, на самом деле, от скуки.  
**Мой tg:** @Woterminze  
**Почта:** qweaspot@gmail.com  



